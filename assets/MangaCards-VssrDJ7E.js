import{_ as ee,r as u,w as te,a as ae,o as l,c as i,b as R,d as e,F,e as se,u as r,f as H,g as o,t as _,n as P,h as S,v as le,i as U,j as $,k as Q,p as ie,l as ne}from"./index-CCmH65T4.js";import{r as oe,_ as ue}from"./ratingConverter-CZb7_kzj.js";import{S as re,_ as z,c as ce,a as Z,b as de,d as q,t as k}from"./timeout-WSEs3MYu.js";const y=A=>(ie("data-v-343574b0"),A=A(),ne(),A),ve={class:"main-anime-card-div"},pe={key:0,class:"poster-div"},_e=["src","alt"],he={key:1,class:"wrap-loader-error"},ge=y(()=>e("div",{class:"loader2"},null,-1)),me=[ge],Ce={key:2,class:"card-details"},be={class:"title"},fe={class:"year-ep-count"},ke={class:"episode-count"},ye={class:"year"},we={key:3,class:"rating-div"},xe=y(()=>e("img",{height:"25px",src:ue,alt:""},null,-1)),Te=["src","onClick"],Ie={key:4,class:"add-to-list-expanded-div"},Me={class:"check-if-plan-to-watch"},Ae={class:"checkbox-wrapper-58"},De={class:"switch"},Se=y(()=>e("span",{class:"slider"},null,-1)),Ve=y(()=>e("h4",null,"manga da leggere",-1)),Le={key:0},Ne={key:1,class:"add-episodes-div"},Re=["onClick"],Ue=["onClick"],$e={key:2},ze={key:3,class:"add-episodes-div"},je={class:"comment-div"},Be={class:"text-area-div"},Fe={key:1},He={class:"date-div"},Pe=y(()=>e("h5",null,"Data di inizio (opz.)",-1)),Qe={key:0},Ze={key:5,class:"wrap-loader-error"},qe=y(()=>e("div",{class:"loader2"},null,-1)),Ge={class:"error-response-div"},Je={__name:"MangaCards",setup(A){const m=$("dataManga"),w=$("isLoading"),x=u(!1),h=u(!1),T=u(""),V=u(0),G=()=>{V.value=T.value.length},s=u(null),C=u(!1),d=u(null),J=t=>{if(s.value===t){s.value=null,L();return}s.value=t,L()},L=()=>{n.value=0,p.value=1,T.value="",V.value=0,M.value=!1,b.value="",D.value="",h.value=!1,C.value=!1},n=u(0),I=t=>{if(n.value>t-1||n.value==="Completato"){C.value=!0,m.value[s.value].attributes.chapterCount===1&&(n.value=1);return}C.value=!1},K=t=>{if(n.value>=t-1||n.value==="Completato"){n.value="Completato",I(t);return}I(t),n.value++},O=t=>{if(n.value<=0){n.value=0,I(t);return}if(n.value==="Completato"){n.value=t-1,I(t);return}n.value--,I(t)},p=u(1),W=()=>{if(p.value>=10){p.value=10;return}p.value+=.5},X=()=>{if(p.value<=1){p.value=1;return}p.value-=.5},M=u(!1),Y=()=>{M.value=!M.value},b=u(""),D=u(""),N=t=>t.split("-").reverse().join("-"),f=()=>{s.value=null,x.value=!1,d.value=null},j=$("userId"),E=async()=>{try{if(x.value=!0,h.value){const t=await Q.post(`https://anime-vue-go-client-production.up.railway.app/add/manga/${j.value}`,{title:m.value[s.value].attributes.canonicalTitle,finished:!1,chapters:0,rating:0,comment:"",starting_date:b.value!==""?N(b.value):"",ending_date:"",plan_to_read:!0,manga_id:parseInt(m.value[s.value].id)},{withCredentials:!0});t.status>=200&&t.status<=209&&(d.value="Aggiunto!",await k(1500),f());return}else{const t=await Q.post(`https://anime-vue-go-client-production.up.railway.app/add/manga/${j.value}`,{title:m.value[s.value].attributes.canonicalTitle,finished:C.value,chapters:n.value==="Completato"?data.value[s.value].attributes.chapterCount:n.value,rating:p.value,comment:T.value,starting_date:N(b.value),ending_date:N(D.value),plan_to_read:!1,manga_id:parseInt(m.value[s.value].id)},{withCredentials:!0});t.status>=200&&t.status<=209&&(d.value="Aggiunto!",await k(1500),f())}}catch(t){console.error(t),t.response.status===409?(d.value="Manga già presente nella tua lista",await k(2500),f()):t.response.status===400?(d.value="Errore, riprova più tardi",await k(2500),f()):t.response.status===401?(d.value="Devi essere registrato per aggiungere manga alla lista!",await k(3e3),f()):(d.value="C'è stato un errore, non si sa perché!",await k(3e3),f())}};return te(()=>m.value,()=>{s.value=null,x.value=!1,d.value=null}),(t,g)=>{const B=ae("router-link");return l(),i(F,null,[R(re),e("div",ve,[(l(!0),i(F,null,se(r(m),(a,c)=>(l(),i("div",{key:c,class:"main-anime-display"},[!r(w)&&s.value!==c?(l(),i("div",pe,[R(B,{to:{name:"MangaInfo",params:{id:c}},class:"router-link"},{default:H(()=>[e("img",{class:"anime-poster",src:a.attributes.posterImage.tiny,alt:a.attributes.canonicalTitle+" poster"},null,8,_e)]),_:2},1032,["to"])])):r(w)?(l(),i("div",he,me)):o("",!0),s.value!==c&&!r(w)?(l(),i("div",Ce,[e("div",null,[R(B,{to:{name:"MangaInfo",params:{id:c}},class:"router-link"},{default:H(()=>[e("span",be,_(a.attributes.canonicalTitle.length>20&&a.attributes.abbreviatedTitles.length>0?r(Z)(a.attributes.abbreviatedTitles):a.attributes.canonicalTitle),1)]),_:2},1032,["to"])]),e("div",fe,[e("span",ke,_(a.attributes.chapterCount>1?"Capitoli: "+a.attributes.chapterCount:a.attributes.chapterCount===null?"N/A":"Manga"),1),e("span",ye,_(a.attributes.status==="finished"?"Finito":"In corso"),1)])])):o("",!0),s.value!==c&&!r(w)?(l(),i("div",we,[xe,e("span",null,_(r(oe)(a.attributes.averageRating)),1)])):o("",!0),e("div",{class:P(s.value!==c?"add-to-list":"add-to-list-close"),"data-tooltip":"Aggiungi alla tua lista"},[r(w)?o("",!0):(l(),i("img",{key:0,height:"35px",src:s.value!==c?r(z):r(ce),alt:"add-to-list",onClick:v=>J(c),id:"add-to-list-button"},null,8,Te))],2),s.value===c&&!x.value?(l(),i("div",Ie,[e("h3",null," Aggiungi:   "+_(a.attributes.canonicalTitle.length>20&&a.attributes.abbreviatedTitles.length>0?r(Z)(a.attributes.abbreviatedTitles):r(de)(a.attributes.canonicalTitle))+" alla tua lista ",1),e("div",Me,[e("div",Ae,[e("label",De,[S(e("input",{onClick:L,type:"checkbox","onUpdate:modelValue":g[0]||(g[0]=v=>h.value=v)},null,512),[[le,h.value]]),Se])]),Ve]),!h.value&&a.attributes.chapterCount!==null&&a.attributes.chapterCount!==1?(l(),i("h4",Le," Numero di capitoli letti ")):o("",!0),!h.value&&a.attributes.chapterCount!==null&&a.attributes.chapterCount!==1?(l(),i("div",Ne,[e("img",{height:"42px",src:q,onClick:v=>O(a.attributes.chapterCount),alt:"minus-svg"},null,8,Re),e("span",null,_(n.value),1),e("img",{height:"35px",src:z,onClick:v=>K(a.attributes.chapterCount),alt:"plus-svg"},null,8,Ue)])):o("",!0),h.value?o("",!0):(l(),i("h4",$e,"Voto")),h.value?o("",!0):(l(),i("div",ze,[e("img",{height:"42px",src:q,onClick:X,alt:"minus-svg"}),e("span",null,_(p.value),1),e("img",{height:"35px",src:z,onClick:W,alt:"plus-svg"})])),e("div",je,[e("button",{onClick:Y},"Nota"),e("div",Be,[M.value?S((l(),i("textarea",{key:0,onInput:G,maxlength:"200","onUpdate:modelValue":g[1]||(g[1]=v=>T.value=v),name:"comment",id:"comment",cols:"20",rows:"5",placeholder:"Questo manga mi è piaciuto/non mi è piaciuto perché..."},`\r
            `,544)),[[U,T.value]]):o("",!0),M.value?(l(),i("span",Fe,_(V.value)+"/200",1)):o("",!0)])]),e("div",He,[Pe,S(e("input",{type:"date","onUpdate:modelValue":g[2]||(g[2]=v=>b.value=v),min:"2000-01-01",max:"2025-12-31"},null,512),[[U,b.value]]),C.value?(l(),i("h5",Qe,"Data di fine (opz.)")):o("",!0),C.value?S((l(),i("input",{key:1,type:"date","onUpdate:modelValue":g[3]||(g[3]=v=>D.value=v),min:"2000-01-01",max:"2025-12-31"},null,512)),[[U,D.value]]):o("",!0)]),e("div",{class:"submit-manga-div"},[e("button",{onClick:E},"Aggiungi")])])):o("",!0),x.value&&s.value===c?(l(),i("div",Ze,[qe,e("div",Ge,[e("span",{class:P(d.value==="Aggiunto!"?"error-green":"")},_(d.value),3)])])):o("",!0)]))),128))])],64)}}},Xe=ee(Je,[["__scopeId","data-v-343574b0"]]);export{Xe as default};
