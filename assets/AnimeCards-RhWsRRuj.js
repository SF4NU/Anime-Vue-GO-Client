import{_ as ee,r as d,c as o,a as M,b as e,F as E,d as te,u as c,o as i,w as Z,e as n,t as h,n as se,f as V,v as ae,g as U,i as L,h as $,j as oe,p as ie,k as le}from"./index-DBZL0Xy4.js";import{r as ne,_ as re}from"./ratingConverter-CZb7_kzj.js";import{_ as ue}from"./youtube-svgrepo-com-DeR6TUWh.js";import{S as de,c as z}from"./SubHeader-B6FilFWZ.js";const F="data:image/svg+xml,%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Transformed%20by:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20width='800px'%20height='800px'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20id='SVGRepo_bgCarrier'%20stroke-width='0'/%3e%3cg%20id='SVGRepo_tracerCarrier'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cg%20id='SVGRepo_iconCarrier'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M22%2012C22%2017.5228%2017.5228%2022%2012%2022C6.47715%2022%202%2017.5228%202%2012C2%206.47715%206.47715%202%2012%202C17.5228%202%2022%206.47715%2022%2012ZM15.75%2012C15.75%2012.4142%2015.4142%2012.75%2015%2012.75H9C8.58579%2012.75%208.25%2012.4142%208.25%2012C8.25%2011.5858%208.58579%2011.25%209%2011.25H15C15.4142%2011.25%2015.75%2011.5858%2015.75%2012Z'%20fill='%2343aa8b'/%3e%3c/g%3e%3c/svg%3e",B="data:image/svg+xml,%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Transformed%20by:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20width='800px'%20height='800px'%20viewBox='0%200%2032%2032'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20xmlns:sketch='http://www.bohemiancoding.com/sketch/ns'%20fill='%23000000'%3e%3cg%20id='SVGRepo_bgCarrier'%20stroke-width='0'/%3e%3cg%20id='SVGRepo_tracerCarrier'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cg%20id='SVGRepo_iconCarrier'%3e%3ctitle%3eplus-circle%3c/title%3e%3cdesc%3eCreated%20with%20Sketch%20Beta.%3c/desc%3e%3cdefs%3e%3c/defs%3e%3cg%20id='Page-1'%20stroke='none'%20stroke-width='1'%20fill='none'%20fill-rule='evenodd'%20sketch:type='MSPage'%3e%3cg%20id='Icon-Set-Filled'%20sketch:type='MSLayerGroup'%20transform='translate(-466.000000,%20-1089.000000)'%20fill='%2343aa8b'%3e%3cpath%20d='M488,1106%20L483,1106%20L483,1111%20C483,1111.55%20482.553,1112%20482,1112%20C481.447,1112%20481,1111.55%20481,1111%20L481,1106%20L476,1106%20C475.447,1106%20475,1105.55%20475,1105%20C475,1104.45%20475.447,1104%20476,1104%20L481,1104%20L481,1099%20C481,1098.45%20481.447,1098%20482,1098%20C482.553,1098%20483,1098.45%20483,1099%20L483,1104%20L488,1104%20C488.553,1104%20489,1104.45%20489,1105%20C489,1105.55%20488.553,1106%20488,1106%20L488,1106%20Z%20M482,1089%20C473.163,1089%20466,1096.16%20466,1105%20C466,1113.84%20473.163,1121%20482,1121%20C490.837,1121%20498,1113.84%20498,1105%20C498,1096.16%20490.837,1089%20482,1089%20L482,1089%20Z'%20id='plus-circle'%20sketch:type='MSShapeGroup'%3e%3c/path%3e%3c/g%3e%3c/g%3e%3c/g%3e%3c/svg%3e",ce=r=>r.slice(0,4);function W(r){return r.length>30?r.substring(0,30)+"...":r}const ve="data:image/svg+xml,%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Transformed%20by:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20width='800px'%20height='800px'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20id='SVGRepo_bgCarrier'%20stroke-width='0'/%3e%3cg%20id='SVGRepo_tracerCarrier'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cg%20id='SVGRepo_iconCarrier'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M22%2012C22%2017.5228%2017.5228%2022%2012%2022C6.47715%2022%202%2017.5228%202%2012C2%206.47715%206.47715%202%2012%202C17.5228%202%2022%206.47715%2022%2012ZM8.96963%208.96965C9.26252%208.67676%209.73739%208.67676%2010.0303%208.96965L12%2010.9393L13.9696%208.96967C14.2625%208.67678%2014.7374%208.67678%2015.0303%208.96967C15.3232%209.26256%2015.3232%209.73744%2015.0303%2010.0303L13.0606%2012L15.0303%2013.9696C15.3232%2014.2625%2015.3232%2014.7374%2015.0303%2015.0303C14.7374%2015.3232%2014.2625%2015.3232%2013.9696%2015.0303L12%2013.0607L10.0303%2015.0303C9.73742%2015.3232%209.26254%2015.3232%208.96965%2015.0303C8.67676%2014.7374%208.67676%2014.2625%208.96965%2013.9697L10.9393%2012L8.96963%2010.0303C8.67673%209.73742%208.67673%209.26254%208.96963%208.96965Z'%20fill='%23ff5900'/%3e%3c/g%3e%3c/svg%3e",P=r=>new Promise((v,D)=>{setTimeout(()=>{v()},r)}),b=r=>(ie("data-v-89e12670"),r=r(),le(),r),pe={class:"main-anime-card-div"},ge={key:0,class:"poster-div"},he=["src","alt"],_e={key:1,class:"loader"},me={key:2,class:"card-details"},Ce={class:"title"},we={class:"year-ep-count"},fe={class:"episode-count"},be={class:"year"},ke={key:3,class:"rating-div"},ye=b(()=>e("img",{height:"25px",src:re,alt:""},null,-1)),xe=["data-tooltip"],Se=["href"],Te=b(()=>e("img",{class:"watch-img",src:ue,alt:"watch-youtube-image"},null,-1)),Ve=[Te],Le=["src","onClick"],De={key:5,class:"add-to-list-expanded-div"},Ge={class:"check-if-plan-to-watch"},Ie={class:"checkbox-wrapper-58"},Re={class:"switch"},Ae=b(()=>e("span",{class:"slider"},null,-1)),Me=b(()=>e("h4",null,"Anime da vedere",-1)),Ue={key:0},Be={key:1,class:"add-episodes-div"},Pe=["onClick"],Ne=["onClick"],je={key:2},Ee={key:3,class:"add-episodes-div"},Ze={class:"comment-div"},$e={class:"text-area-div"},ze={key:1},Fe={class:"date-div"},We=b(()=>e("h5",null,"Data di inizio (opz.)",-1)),Ye={key:0},He={key:6,class:"wrap-loader-error"},Oe=b(()=>e("div",{class:"loader2"},null,-1)),Qe={class:"error-response-div"},qe={__name:"AnimeCards",setup(r){const v=L("data"),D=L("isLoading"),C=d(!1);L("isLoggedIn");const _=d(!1),k=d(""),G=d(0),Y=()=>{G.value=k.value.length},y=d(null),w=d(!1),a=d(null),H=t=>{if(a.value===t){a.value=null,I();return}a.value=t,I()},I=()=>{l.value=0,g.value=1,k.value="",G.value=0,S.value=!1,f.value="",T.value="",_.value=!1,w.value=!1},l=d(0),x=t=>{if(l.value>t-1||l.value==="Completato"){w.value=!0,v.value[a.value].attributes.episodeCount===1&&(l.value=1);return}w.value=!1},O=t=>{if(l.value>=t-1||l.value==="Completato"){l.value="Completato",x(t);return}x(t),l.value++},Q=t=>{if(l.value<=0){l.value=0,x(t);return}if(l.value==="Completato"){l.value=t-1,x(t);return}l.value--,x(t)},g=d(1),q=()=>{if(g.value>=10){g.value=10;return}g.value+=.5},J=()=>{if(g.value<=1){g.value=1;return}g.value-=.5},S=d(!1),K=()=>{S.value=!S.value},f=d(""),T=d(""),R=t=>t.split("-").reverse().join("-"),N=L("userId"),X=async()=>{try{if(C.value=!0,_.value){const t=await $.post(`https://anime-vue-go-client-production.up.railway.app/add/anime/${N.value}`,{title:v.value[a.value].attributes.canonicalTitle,finished:!1,episodes:0,rating:0,comment:"",starting_date:f.value!==""?R(f.value):"",ending_date:"",plan_to_watch:!0,anime_id:parseInt(v.value[a.value].id)},{withCredentials:!0});t.status>=200&&t.status<=209&&(a.value=null,C.value=!1);return}else{const t=await $.post(`https://anime-vue-go-client-production.up.railway.app/add/anime/${N.value}`,{title:v.value[a.value].attributes.canonicalTitle,finished:w.value,episodes:l.value==="Completato"?v.value[a.value].attributes.episodeCount:l.value,rating:g.value,comment:k.value,starting_date:R(f.value),ending_date:R(T.value),plan_to_watch:!1,anime_id:parseInt(v.value[a.value].id)},{withCredentials:!0});t.status>=200&&t.status<=209&&(a.value=null,C.value=!1)}}catch(t){console.error(t),t.response.status===409?(y.value="Anime già presente nella tua lista",await P(2500),A()):t.response.status===400?(y.value="Errore, riprova più tardi",await P(2500),A()):t.response.status===401&&(y.value="Devi essere registrato per aggiungere anime alla lista!",await P(3e3),A())}},A=()=>{a.value=null,C.value=!1,y.value=null};return(t,m)=>{const j=oe("router-link");return i(),o(E,null,[M(de),e("div",pe,[(i(!0),o(E,null,te(c(v),(s,u)=>(i(),o("div",{key:u,class:"main-anime-display"},[!c(D)&&a.value!==u?(i(),o("div",ge,[M(j,{to:{name:"AnimeInfo",params:{id:u}},class:"router-link"},{default:Z(()=>[e("img",{class:"anime-poster",src:s.attributes.posterImage.tiny,alt:s.attributes.canonicalTitle+" poster"},null,8,he)]),_:2},1032,["to"])])):c(D)?(i(),o("div",_e)):n("",!0),a.value!==u?(i(),o("div",me,[e("div",null,[M(j,{to:{name:"AnimeInfo",params:{id:u}},class:"router-link"},{default:Z(()=>[e("span",Ce,h(s.attributes.canonicalTitle.length>20&&s.attributes.abbreviatedTitles.length>0?c(z)(s.attributes.abbreviatedTitles):c(W)(s.attributes.canonicalTitle)),1)]),_:2},1032,["to"])]),e("div",we,[e("span",fe,h(s.attributes.episodeCount>1?"Episodi: "+s.attributes.episodeCount:s.attributes.episodeCount===null?"N/A":"Film"),1),e("span",be,h(s.attributes.endDate?"Anno: "+c(ce)(s.attributes.endDate):"In corso"),1)])])):n("",!0),a.value!==u?(i(),o("div",ke,[ye,e("span",null,h(c(ne)(s.attributes.averageRating)),1)])):n("",!0),a.value!==u?(i(),o("div",{key:4,class:"trailer-link-div","data-tooltip":`https://www.youtube.com/watch?v=${s.attributes.youtubeVideoId}`},[e("span",null,[e("a",{href:`https://www.youtube.com/watch?v=${s.attributes.youtubeVideoId}`,target:"_blank",class:"watch-link"},Ve,8,Se)])],8,xe)):n("",!0),e("div",{class:se(a.value!==u?"add-to-list":"add-to-list-close"),"data-tooltip":"Aggiungi alla tua lista"},[e("img",{height:"35px",src:a.value!==u?c(B):c(ve),alt:"add-to-list",onClick:p=>H(u),id:"add-to-list-button"},null,8,Le)],2),a.value===u&&!C.value?(i(),o("div",De,[e("h3",null," Aggiungi:   "+h(s.attributes.canonicalTitle.length>20&&s.attributes.abbreviatedTitles.length>0?c(z)(s.attributes.abbreviatedTitles):c(W)(s.attributes.canonicalTitle))+" alla tua lista ",1),e("div",Ge,[e("div",Ie,[e("label",Re,[V(e("input",{onClick:I,type:"checkbox","onUpdate:modelValue":m[0]||(m[0]=p=>_.value=p)},null,512),[[ae,_.value]]),Ae])]),Me]),!_.value&&s.attributes.episodeCount!==null&&s.attributes.episodeCount!==1?(i(),o("h4",Ue," Numero di episodi visti ")):n("",!0),!_.value&&s.attributes.episodeCount!==null&&s.attributes.episodeCount!==1?(i(),o("div",Be,[e("img",{height:"42px",src:F,onClick:p=>Q(s.attributes.episodeCount),alt:"minus-svg"},null,8,Pe),e("span",null,h(l.value),1),e("img",{height:"35px",src:B,onClick:p=>O(s.attributes.episodeCount),alt:"plus-svg"},null,8,Ne)])):n("",!0),_.value?n("",!0):(i(),o("h4",je,"Voto")),_.value?n("",!0):(i(),o("div",Ee,[e("img",{height:"42px",src:F,onClick:J,alt:"minus-svg"}),e("span",null,h(g.value),1),e("img",{height:"35px",src:B,onClick:q,alt:"plus-svg"})])),e("div",Ze,[e("button",{onClick:K},"Nota"),e("div",$e,[S.value?V((i(),o("textarea",{key:0,onInput:Y,maxlength:"200","onUpdate:modelValue":m[1]||(m[1]=p=>k.value=p),name:"comment",id:"comment",cols:"20",rows:"5",placeholder:"Questo anime mi è piaciuto/non mi è piaciuto perché..."},`\r
            `,544)),[[U,k.value]]):n("",!0),S.value?(i(),o("span",ze,h(G.value)+"/200",1)):n("",!0)])]),e("div",Fe,[We,V(e("input",{type:"date","onUpdate:modelValue":m[2]||(m[2]=p=>f.value=p),min:"2000-01-01",max:"2025-12-31"},null,512),[[U,f.value]]),w.value?(i(),o("h5",Ye,"Data di fine (opz.)")):n("",!0),w.value?V((i(),o("input",{key:1,type:"date","onUpdate:modelValue":m[3]||(m[3]=p=>T.value=p),min:"2000-01-01",max:"2025-12-31"},null,512)),[[U,T.value]]):n("",!0)]),e("div",{class:"submit-anime-div"},[e("button",{onClick:X},"Aggiungi")])])):n("",!0),C.value&&a.value===u?(i(),o("div",He,[Oe,e("div",Qe,[e("span",null,h(y.value),1)])])):n("",!0)]))),128))])],64)}}},tt=ee(qe,[["__scopeId","data-v-89e12670"]]);export{tt as default};
