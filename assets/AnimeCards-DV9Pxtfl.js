import{_ as te,r as d,w as ae,a as se,o as l,c as o,b as R,d as e,F as M,e as le,u as n,f as E,g as u,t as h,n as H,h as L,v as oe,i as z,j as S,k as P,p as ie,l as ne}from"./index-CCmH65T4.js";import{r as ue,_ as re}from"./ratingConverter-CZb7_kzj.js";import{_ as de}from"./youtube-svgrepo-com-DeR6TUWh.js";import{S as ce,_ as j,c as ve,a as Q,b as W,d as Y,t as A}from"./timeout-WSEs3MYu.js";const pe=f=>f.slice(0,4),b=f=>(ie("data-v-124182b8"),f=f(),ne(),f),_e={class:"main-anime-card-div"},he={key:0,class:"poster-div"},ge=["src","alt"],me={key:1,class:"wrap-loader-error"},be=b(()=>e("div",{class:"loader2"},null,-1)),fe=[be],Ce={key:2,class:"card-details"},ke={class:"title"},we={class:"year-ep-count"},ye={class:"episode-count"},Ae={class:"year"},xe={key:3,class:"rating-div"},Ie=b(()=>e("img",{height:"25px",src:re,alt:""},null,-1)),Te=["data-tooltip"],De=["href"],Ve=b(()=>e("img",{class:"watch-img",src:de,alt:"watch-youtube-image"},null,-1)),Le=[Ve],Se=["src","onClick"],$e={key:5,class:"add-to-list-expanded-div"},Ne={class:"check-if-plan-to-watch"},Ue={class:"checkbox-wrapper-58"},Re={class:"switch"},ze=b(()=>e("span",{class:"slider"},null,-1)),je=b(()=>e("h4",null,"Anime da vedere",-1)),Be={key:0},Fe={key:1,class:"add-episodes-div"},Me=["onClick"],Ee=["onClick"],He={key:2},Pe={key:3,class:"add-episodes-div"},Qe={class:"comment-div"},We={class:"text-area-div"},Ye={key:1},Ze={class:"date-div"},qe=b(()=>e("h5",null,"Data di inizio (opz.)",-1)),Ge={key:0},Je={key:6,class:"wrap-loader-error"},Ke=b(()=>e("div",{class:"loader2"},null,-1)),Oe={class:"error-response-div"},Xe={__name:"AnimeCards",setup(f){const p=S("data"),C=S("isLoading"),x=d(!1);S("isLoggedIn");const g=d(!1),I=d(""),$=d(0),Z=()=>{$.value=I.value.length},c=d(null),k=d(!1),s=d(null),q=t=>{if(s.value===t){s.value=null,N();return}s.value=t,N()},N=()=>{i.value=0,_.value=1,I.value="",$.value=0,D.value=!1,w.value="",V.value="",g.value=!1,k.value=!1},i=d(0),T=t=>{if(i.value>t-1||i.value==="Completato"){k.value=!0,p.value[s.value].attributes.episodeCount===1&&(i.value=1);return}k.value=!1},G=t=>{if(i.value>=t-1||i.value==="Completato"){i.value="Completato",T(t);return}T(t),i.value++},J=t=>{if(i.value<=0){i.value=0,T(t);return}if(i.value==="Completato"){i.value=t-1,T(t);return}i.value--,T(t)},_=d(1),K=()=>{if(_.value>=10){_.value=10;return}_.value+=.5},O=()=>{if(_.value<=1){_.value=1;return}_.value-=.5},D=d(!1),X=()=>{D.value=!D.value},w=d(""),V=d(""),U=t=>t.split("-").reverse().join("-"),B=S("userId"),ee=async()=>{try{if(x.value=!0,g.value){const t=await P.post(`https://anime-vue-go-client-production.up.railway.app/add/anime/${B.value}`,{title:p.value[s.value].attributes.canonicalTitle,finished:!1,episodes:0,rating:0,comment:"",starting_date:w.value!==""?U(w.value):"",ending_date:"",plan_to_watch:!0,anime_id:parseInt(p.value[s.value].id)},{withCredentials:!0});t.status>=200&&t.status<=209&&(c.value="Aggiunto!",await A(1500),y());return}else{const t=await P.post(`https://anime-vue-go-client-production.up.railway.app/add/anime/${B.value}`,{title:p.value[s.value].attributes.canonicalTitle,finished:k.value,episodes:i.value==="Completato"?p.value[s.value].attributes.episodeCount:i.value,rating:_.value,comment:I.value,starting_date:U(w.value),ending_date:U(V.value),plan_to_watch:!1,anime_id:parseInt(p.value[s.value].id)},{withCredentials:!0});t.status>=200&&t.status<=209&&(c.value="Aggiunto!",await A(1500),y())}}catch(t){console.error(t),t.response.status===409?(c.value="Anime già presente nella tua lista",await A(2500),y()):t.response.status===400?(c.value="Errore, riprova più tardi",await A(2500),y()):t.response.status===401?(c.value="Devi essere registrato per aggiungere anime alla lista!",await A(3e3),y()):(c.value="C'è stato un errore, non si sa perché!",await A(3e3),y())}},y=()=>{s.value=null,x.value=!1,c.value=null};return ae(()=>p.value,()=>{s.value=null,x.value=!1,c.value=null}),(t,m)=>{const F=se("router-link");return l(),o(M,null,[R(ce),e("div",_e,[(l(!0),o(M,null,le(n(p),(a,r)=>(l(),o("div",{key:r,class:"main-anime-display"},[!n(C)&&s.value!==r?(l(),o("div",he,[R(F,{to:{name:"AnimeInfo",params:{id:r}},class:"router-link"},{default:E(()=>[e("img",{class:"anime-poster",src:a.attributes.posterImage.tiny,alt:a.attributes.canonicalTitle+" poster"},null,8,ge)]),_:2},1032,["to"])])):n(C)?(l(),o("div",me,fe)):u("",!0),s.value!==r&&!n(C)?(l(),o("div",Ce,[e("div",null,[R(F,{to:{name:"AnimeInfo",params:{id:r}},class:"router-link"},{default:E(()=>[e("span",ke,h(a.attributes.canonicalTitle.length>20&&a.attributes.abbreviatedTitles.length>0?n(Q)(a.attributes.abbreviatedTitles):n(W)(a.attributes.canonicalTitle)),1)]),_:2},1032,["to"])]),e("div",we,[e("span",ye,h(a.attributes.episodeCount>1?"Episodi: "+a.attributes.episodeCount:a.attributes.episodeCount===null?"N/A":"Film"),1),e("span",Ae,h(a.attributes.endDate?"Anno: "+n(pe)(a.attributes.endDate):"In corso"),1)])])):u("",!0),s.value!==r&&!n(C)?(l(),o("div",xe,[Ie,e("span",null,h(n(ue)(a.attributes.averageRating)),1)])):u("",!0),s.value!==r&&!n(C)?(l(),o("div",{key:4,class:"trailer-link-div","data-tooltip":`https://www.youtube.com/watch?v=${a.attributes.youtubeVideoId}`},[e("span",null,[e("a",{href:`https://www.youtube.com/watch?v=${a.attributes.youtubeVideoId}`,target:"_blank",class:"watch-link"},Le,8,De)])],8,Te)):u("",!0),e("div",{class:H(s.value!==r?"add-to-list":"add-to-list-close"),"data-tooltip":"Aggiungi alla tua lista"},[n(C)?u("",!0):(l(),o("img",{key:0,height:"35px",src:s.value!==r?n(j):n(ve),alt:"add-to-list",onClick:v=>q(r),id:"add-to-list-button"},null,8,Se))],2),s.value===r&&!x.value?(l(),o("div",$e,[e("h3",null," Aggiungi:   "+h(a.attributes.canonicalTitle.length>20&&a.attributes.abbreviatedTitles.length>0?n(Q)(a.attributes.abbreviatedTitles):n(W)(a.attributes.canonicalTitle))+" alla tua lista ",1),e("div",Ne,[e("div",Ue,[e("label",Re,[L(e("input",{onClick:N,type:"checkbox","onUpdate:modelValue":m[0]||(m[0]=v=>g.value=v)},null,512),[[oe,g.value]]),ze])]),je]),!g.value&&a.attributes.episodeCount!==null&&a.attributes.episodeCount!==1?(l(),o("h4",Be," Numero di episodi visti ")):u("",!0),!g.value&&a.attributes.episodeCount!==null&&a.attributes.episodeCount!==1?(l(),o("div",Fe,[e("img",{height:"42px",src:Y,onClick:v=>J(a.attributes.episodeCount),alt:"minus-svg"},null,8,Me),e("span",null,h(i.value),1),e("img",{height:"35px",src:j,onClick:v=>G(a.attributes.episodeCount),alt:"plus-svg"},null,8,Ee)])):u("",!0),g.value?u("",!0):(l(),o("h4",He,"Voto")),g.value?u("",!0):(l(),o("div",Pe,[e("img",{height:"42px",src:Y,onClick:O,alt:"minus-svg"}),e("span",null,h(_.value),1),e("img",{height:"35px",src:j,onClick:K,alt:"plus-svg"})])),e("div",Qe,[e("button",{onClick:X},"Nota"),e("div",We,[D.value?L((l(),o("textarea",{key:0,onInput:Z,maxlength:"200","onUpdate:modelValue":m[1]||(m[1]=v=>I.value=v),name:"comment",id:"comment",cols:"20",rows:"5",placeholder:"Questo anime mi è piaciuto/non mi è piaciuto perché..."},`\r
            `,544)),[[z,I.value]]):u("",!0),D.value?(l(),o("span",Ye,h($.value)+"/200",1)):u("",!0)])]),e("div",Ze,[qe,L(e("input",{type:"date","onUpdate:modelValue":m[2]||(m[2]=v=>w.value=v),min:"2000-01-01",max:"2025-12-31"},null,512),[[z,w.value]]),k.value?(l(),o("h5",Ge,"Data di fine (opz.)")):u("",!0),k.value?L((l(),o("input",{key:1,type:"date","onUpdate:modelValue":m[3]||(m[3]=v=>V.value=v),min:"2000-01-01",max:"2025-12-31"},null,512)),[[z,V.value]]):u("",!0)]),e("div",{class:"submit-anime-div"},[e("button",{onClick:ee},"Aggiungi")])])):u("",!0),x.value&&s.value===r?(l(),o("div",Je,[Ke,e("div",Oe,[e("span",{class:H(c.value==="Aggiunto!"?"error-green":"")},h(c.value),3)])])):u("",!0)]))),128))])],64)}}},lt=te(Xe,[["__scopeId","data-v-124182b8"]]);export{lt as default};
