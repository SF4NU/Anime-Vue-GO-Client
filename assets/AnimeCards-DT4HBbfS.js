import{_ as ee,r as c,c as o,a as M,b as e,F as E,d as te,u as n,o as i,w as Z,e as r,t as h,n as se,f as L,v as ae,g as U,i as D,h as $,j as oe,p as ie,k as le}from"./index-C7u6g-p0.js";import{r as ne,_ as re}from"./ratingConverter-CZb7_kzj.js";import{_ as ue}from"./youtube-svgrepo-com-DeR6TUWh.js";import{S as de,c as z}from"./SubHeader-DnRqfIkF.js";const F="data:image/svg+xml,%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Transformed%20by:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20width='800px'%20height='800px'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20id='SVGRepo_bgCarrier'%20stroke-width='0'/%3e%3cg%20id='SVGRepo_tracerCarrier'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cg%20id='SVGRepo_iconCarrier'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M22%2012C22%2017.5228%2017.5228%2022%2012%2022C6.47715%2022%202%2017.5228%202%2012C2%206.47715%206.47715%202%2012%202C17.5228%202%2022%206.47715%2022%2012ZM15.75%2012C15.75%2012.4142%2015.4142%2012.75%2015%2012.75H9C8.58579%2012.75%208.25%2012.4142%208.25%2012C8.25%2011.5858%208.58579%2011.25%209%2011.25H15C15.4142%2011.25%2015.75%2011.5858%2015.75%2012Z'%20fill='%2343aa8b'/%3e%3c/g%3e%3c/svg%3e",B="data:image/svg+xml,%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Transformed%20by:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20width='800px'%20height='800px'%20viewBox='0%200%2032%2032'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20xmlns:sketch='http://www.bohemiancoding.com/sketch/ns'%20fill='%23000000'%3e%3cg%20id='SVGRepo_bgCarrier'%20stroke-width='0'/%3e%3cg%20id='SVGRepo_tracerCarrier'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cg%20id='SVGRepo_iconCarrier'%3e%3ctitle%3eplus-circle%3c/title%3e%3cdesc%3eCreated%20with%20Sketch%20Beta.%3c/desc%3e%3cdefs%3e%3c/defs%3e%3cg%20id='Page-1'%20stroke='none'%20stroke-width='1'%20fill='none'%20fill-rule='evenodd'%20sketch:type='MSPage'%3e%3cg%20id='Icon-Set-Filled'%20sketch:type='MSLayerGroup'%20transform='translate(-466.000000,%20-1089.000000)'%20fill='%2343aa8b'%3e%3cpath%20d='M488,1106%20L483,1106%20L483,1111%20C483,1111.55%20482.553,1112%20482,1112%20C481.447,1112%20481,1111.55%20481,1111%20L481,1106%20L476,1106%20C475.447,1106%20475,1105.55%20475,1105%20C475,1104.45%20475.447,1104%20476,1104%20L481,1104%20L481,1099%20C481,1098.45%20481.447,1098%20482,1098%20C482.553,1098%20483,1098.45%20483,1099%20L483,1104%20L488,1104%20C488.553,1104%20489,1104.45%20489,1105%20C489,1105.55%20488.553,1106%20488,1106%20L488,1106%20Z%20M482,1089%20C473.163,1089%20466,1096.16%20466,1105%20C466,1113.84%20473.163,1121%20482,1121%20C490.837,1121%20498,1113.84%20498,1105%20C498,1096.16%20490.837,1089%20482,1089%20L482,1089%20Z'%20id='plus-circle'%20sketch:type='MSShapeGroup'%3e%3c/path%3e%3c/g%3e%3c/g%3e%3c/g%3e%3c/svg%3e",ce=u=>u.slice(0,4);function W(u){return u.length>30?u.substring(0,30)+"...":u}const ve="data:image/svg+xml,%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Transformed%20by:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20width='800px'%20height='800px'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20id='SVGRepo_bgCarrier'%20stroke-width='0'/%3e%3cg%20id='SVGRepo_tracerCarrier'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cg%20id='SVGRepo_iconCarrier'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M22%2012C22%2017.5228%2017.5228%2022%2012%2022C6.47715%2022%202%2017.5228%202%2012C2%206.47715%206.47715%202%2012%202C17.5228%202%2022%206.47715%2022%2012ZM8.96963%208.96965C9.26252%208.67676%209.73739%208.67676%2010.0303%208.96965L12%2010.9393L13.9696%208.96967C14.2625%208.67678%2014.7374%208.67678%2015.0303%208.96967C15.3232%209.26256%2015.3232%209.73744%2015.0303%2010.0303L13.0606%2012L15.0303%2013.9696C15.3232%2014.2625%2015.3232%2014.7374%2015.0303%2015.0303C14.7374%2015.3232%2014.2625%2015.3232%2013.9696%2015.0303L12%2013.0607L10.0303%2015.0303C9.73742%2015.3232%209.26254%2015.3232%208.96965%2015.0303C8.67676%2014.7374%208.67676%2014.2625%208.96965%2013.9697L10.9393%2012L8.96963%2010.0303C8.67673%209.73742%208.67673%209.26254%208.96963%208.96965Z'%20fill='%23ff5900'/%3e%3c/g%3e%3c/svg%3e",P=u=>new Promise((v,C)=>{setTimeout(()=>{v()},u)}),w=u=>(ie("data-v-26d8492f"),u=u(),le(),u),pe={class:"main-anime-card-div"},ge={key:0,class:"poster-div"},he=["src","alt"],_e={key:1,class:"wrap-loader-error"},me=w(()=>e("div",{class:"loader2"},null,-1)),Ce=[me],we={key:2,class:"card-details"},fe={class:"title"},be={class:"year-ep-count"},ke={class:"episode-count"},ye={class:"year"},xe={key:3,class:"rating-div"},Se=w(()=>e("img",{height:"25px",src:re,alt:""},null,-1)),Te=["data-tooltip"],Ve=["href"],Le=w(()=>e("img",{class:"watch-img",src:ue,alt:"watch-youtube-image"},null,-1)),De=[Le],Ge=["src","onClick"],Ie={key:5,class:"add-to-list-expanded-div"},Re={class:"check-if-plan-to-watch"},Ae={class:"checkbox-wrapper-58"},Me={class:"switch"},Ue=w(()=>e("span",{class:"slider"},null,-1)),Be=w(()=>e("h4",null,"Anime da vedere",-1)),Pe={key:0},Ne={key:1,class:"add-episodes-div"},je=["onClick"],Ee=["onClick"],Ze={key:2},$e={key:3,class:"add-episodes-div"},ze={class:"comment-div"},Fe={class:"text-area-div"},We={key:1},Ye={class:"date-div"},He=w(()=>e("h5",null,"Data di inizio (opz.)",-1)),Oe={key:0},Qe={key:6,class:"wrap-loader-error"},qe=w(()=>e("div",{class:"loader2"},null,-1)),Je={class:"error-response-div"},Ke={__name:"AnimeCards",setup(u){const v=D("data"),C=D("isLoading"),f=c(!1);D("isLoggedIn");const _=c(!1),y=c(""),G=c(0),Y=()=>{G.value=y.value.length},x=c(null),b=c(!1),a=c(null),H=t=>{if(a.value===t){a.value=null,I();return}a.value=t,I()},I=()=>{l.value=0,g.value=1,y.value="",G.value=0,T.value=!1,k.value="",V.value="",_.value=!1,b.value=!1},l=c(0),S=t=>{if(l.value>t-1||l.value==="Completato"){b.value=!0,v.value[a.value].attributes.episodeCount===1&&(l.value=1);return}b.value=!1},O=t=>{if(l.value>=t-1||l.value==="Completato"){l.value="Completato",S(t);return}S(t),l.value++},Q=t=>{if(l.value<=0){l.value=0,S(t);return}if(l.value==="Completato"){l.value=t-1,S(t);return}l.value--,S(t)},g=c(1),q=()=>{if(g.value>=10){g.value=10;return}g.value+=.5},J=()=>{if(g.value<=1){g.value=1;return}g.value-=.5},T=c(!1),K=()=>{T.value=!T.value},k=c(""),V=c(""),R=t=>t.split("-").reverse().join("-"),N=D("userId"),X=async()=>{try{if(f.value=!0,_.value){const t=await $.post(`https://anime-vue-go-client-production.up.railway.app/add/anime/${N.value}`,{title:v.value[a.value].attributes.canonicalTitle,finished:!1,episodes:0,rating:0,comment:"",starting_date:k.value!==""?R(k.value):"",ending_date:"",plan_to_watch:!0,anime_id:parseInt(v.value[a.value].id)},{withCredentials:!0});t.status>=200&&t.status<=209&&(a.value=null,f.value=!1);return}else{const t=await $.post(`https://anime-vue-go-client-production.up.railway.app/add/anime/${N.value}`,{title:v.value[a.value].attributes.canonicalTitle,finished:b.value,episodes:l.value==="Completato"?v.value[a.value].attributes.episodeCount:l.value,rating:g.value,comment:y.value,starting_date:R(k.value),ending_date:R(V.value),plan_to_watch:!1,anime_id:parseInt(v.value[a.value].id)},{withCredentials:!0});t.status>=200&&t.status<=209&&(a.value=null,f.value=!1)}}catch(t){console.error(t),t.response.status===409?(x.value="Anime già presente nella tua lista",await P(2500),A()):t.response.status===400?(x.value="Errore, riprova più tardi",await P(2500),A()):t.response.status===401&&(x.value="Devi essere registrato per aggiungere anime alla lista!",await P(3e3),A())}},A=()=>{a.value=null,f.value=!1,x.value=null};return(t,m)=>{const j=oe("router-link");return i(),o(E,null,[M(de),e("div",pe,[(i(!0),o(E,null,te(n(v),(s,d)=>(i(),o("div",{key:d,class:"main-anime-display"},[!n(C)&&a.value!==d?(i(),o("div",ge,[M(j,{to:{name:"AnimeInfo",params:{id:d}},class:"router-link"},{default:Z(()=>[e("img",{class:"anime-poster",src:s.attributes.posterImage.tiny,alt:s.attributes.canonicalTitle+" poster"},null,8,he)]),_:2},1032,["to"])])):n(C)?(i(),o("div",_e,Ce)):r("",!0),a.value!==d&&!n(C)?(i(),o("div",we,[e("div",null,[M(j,{to:{name:"AnimeInfo",params:{id:d}},class:"router-link"},{default:Z(()=>[e("span",fe,h(s.attributes.canonicalTitle.length>20&&s.attributes.abbreviatedTitles.length>0?n(z)(s.attributes.abbreviatedTitles):n(W)(s.attributes.canonicalTitle)),1)]),_:2},1032,["to"])]),e("div",be,[e("span",ke,h(s.attributes.episodeCount>1?"Episodi: "+s.attributes.episodeCount:s.attributes.episodeCount===null?"N/A":"Film"),1),e("span",ye,h(s.attributes.endDate?"Anno: "+n(ce)(s.attributes.endDate):"In corso"),1)])])):r("",!0),a.value!==d&&!n(C)?(i(),o("div",xe,[Se,e("span",null,h(n(ne)(s.attributes.averageRating)),1)])):r("",!0),a.value!==d&&!n(C)?(i(),o("div",{key:4,class:"trailer-link-div","data-tooltip":`https://www.youtube.com/watch?v=${s.attributes.youtubeVideoId}`},[e("span",null,[e("a",{href:`https://www.youtube.com/watch?v=${s.attributes.youtubeVideoId}`,target:"_blank",class:"watch-link"},De,8,Ve)])],8,Te)):r("",!0),e("div",{class:se(a.value!==d?"add-to-list":"add-to-list-close"),"data-tooltip":"Aggiungi alla tua lista"},[n(C)?r("",!0):(i(),o("img",{key:0,height:"35px",src:a.value!==d?n(B):n(ve),alt:"add-to-list",onClick:p=>H(d),id:"add-to-list-button"},null,8,Ge))],2),a.value===d&&!f.value?(i(),o("div",Ie,[e("h3",null," Aggiungi:   "+h(s.attributes.canonicalTitle.length>20&&s.attributes.abbreviatedTitles.length>0?n(z)(s.attributes.abbreviatedTitles):n(W)(s.attributes.canonicalTitle))+" alla tua lista ",1),e("div",Re,[e("div",Ae,[e("label",Me,[L(e("input",{onClick:I,type:"checkbox","onUpdate:modelValue":m[0]||(m[0]=p=>_.value=p)},null,512),[[ae,_.value]]),Ue])]),Be]),!_.value&&s.attributes.episodeCount!==null&&s.attributes.episodeCount!==1?(i(),o("h4",Pe," Numero di episodi visti ")):r("",!0),!_.value&&s.attributes.episodeCount!==null&&s.attributes.episodeCount!==1?(i(),o("div",Ne,[e("img",{height:"42px",src:F,onClick:p=>Q(s.attributes.episodeCount),alt:"minus-svg"},null,8,je),e("span",null,h(l.value),1),e("img",{height:"35px",src:B,onClick:p=>O(s.attributes.episodeCount),alt:"plus-svg"},null,8,Ee)])):r("",!0),_.value?r("",!0):(i(),o("h4",Ze,"Voto")),_.value?r("",!0):(i(),o("div",$e,[e("img",{height:"42px",src:F,onClick:J,alt:"minus-svg"}),e("span",null,h(g.value),1),e("img",{height:"35px",src:B,onClick:q,alt:"plus-svg"})])),e("div",ze,[e("button",{onClick:K},"Nota"),e("div",Fe,[T.value?L((i(),o("textarea",{key:0,onInput:Y,maxlength:"200","onUpdate:modelValue":m[1]||(m[1]=p=>y.value=p),name:"comment",id:"comment",cols:"20",rows:"5",placeholder:"Questo anime mi è piaciuto/non mi è piaciuto perché..."},`\r
            `,544)),[[U,y.value]]):r("",!0),T.value?(i(),o("span",We,h(G.value)+"/200",1)):r("",!0)])]),e("div",Ye,[He,L(e("input",{type:"date","onUpdate:modelValue":m[2]||(m[2]=p=>k.value=p),min:"2000-01-01",max:"2025-12-31"},null,512),[[U,k.value]]),b.value?(i(),o("h5",Oe,"Data di fine (opz.)")):r("",!0),b.value?L((i(),o("input",{key:1,type:"date","onUpdate:modelValue":m[3]||(m[3]=p=>V.value=p),min:"2000-01-01",max:"2025-12-31"},null,512)),[[U,V.value]]):r("",!0)]),e("div",{class:"submit-anime-div"},[e("button",{onClick:X},"Aggiungi")])])):r("",!0),f.value&&a.value===d?(i(),o("div",Qe,[qe,e("div",Je,[e("span",null,h(x.value),1)])])):r("",!0)]))),128))])],64)}}},at=ee(Ke,[["__scopeId","data-v-26d8492f"]]);export{at as default};
