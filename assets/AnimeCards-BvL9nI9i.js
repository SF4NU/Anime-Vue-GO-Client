import{_ as ee,r as c,w as te,a as se,o,c as l,b as M,d as e,F as E,e as ae,u as n,f as Z,g as r,t as h,n as oe,h as L,v as le,i as U,j as D,k as $,p as ie,l as ne}from"./index-BGXx5LPC.js";import{r as re,_ as ue}from"./ratingConverter-CZb7_kzj.js";import{_ as de}from"./youtube-svgrepo-com-DeR6TUWh.js";import{S as ce,c as z}from"./SubHeader-Ct6hoj_t.js";const F="data:image/svg+xml,%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Transformed%20by:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20width='800px'%20height='800px'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20id='SVGRepo_bgCarrier'%20stroke-width='0'/%3e%3cg%20id='SVGRepo_tracerCarrier'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cg%20id='SVGRepo_iconCarrier'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M22%2012C22%2017.5228%2017.5228%2022%2012%2022C6.47715%2022%202%2017.5228%202%2012C2%206.47715%206.47715%202%2012%202C17.5228%202%2022%206.47715%2022%2012ZM15.75%2012C15.75%2012.4142%2015.4142%2012.75%2015%2012.75H9C8.58579%2012.75%208.25%2012.4142%208.25%2012C8.25%2011.5858%208.58579%2011.25%209%2011.25H15C15.4142%2011.25%2015.75%2011.5858%2015.75%2012Z'%20fill='%2343aa8b'/%3e%3c/g%3e%3c/svg%3e",B="data:image/svg+xml,%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Transformed%20by:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20width='800px'%20height='800px'%20viewBox='0%200%2032%2032'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20xmlns:sketch='http://www.bohemiancoding.com/sketch/ns'%20fill='%23000000'%3e%3cg%20id='SVGRepo_bgCarrier'%20stroke-width='0'/%3e%3cg%20id='SVGRepo_tracerCarrier'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cg%20id='SVGRepo_iconCarrier'%3e%3ctitle%3eplus-circle%3c/title%3e%3cdesc%3eCreated%20with%20Sketch%20Beta.%3c/desc%3e%3cdefs%3e%3c/defs%3e%3cg%20id='Page-1'%20stroke='none'%20stroke-width='1'%20fill='none'%20fill-rule='evenodd'%20sketch:type='MSPage'%3e%3cg%20id='Icon-Set-Filled'%20sketch:type='MSLayerGroup'%20transform='translate(-466.000000,%20-1089.000000)'%20fill='%2343aa8b'%3e%3cpath%20d='M488,1106%20L483,1106%20L483,1111%20C483,1111.55%20482.553,1112%20482,1112%20C481.447,1112%20481,1111.55%20481,1111%20L481,1106%20L476,1106%20C475.447,1106%20475,1105.55%20475,1105%20C475,1104.45%20475.447,1104%20476,1104%20L481,1104%20L481,1099%20C481,1098.45%20481.447,1098%20482,1098%20C482.553,1098%20483,1098.45%20483,1099%20L483,1104%20L488,1104%20C488.553,1104%20489,1104.45%20489,1105%20C489,1105.55%20488.553,1106%20488,1106%20L488,1106%20Z%20M482,1089%20C473.163,1089%20466,1096.16%20466,1105%20C466,1113.84%20473.163,1121%20482,1121%20C490.837,1121%20498,1113.84%20498,1105%20C498,1096.16%20490.837,1089%20482,1089%20L482,1089%20Z'%20id='plus-circle'%20sketch:type='MSShapeGroup'%3e%3c/path%3e%3c/g%3e%3c/g%3e%3c/g%3e%3c/svg%3e",ve=u=>u.slice(0,4);function W(u){return u.length>30?u.substring(0,30)+"...":u}const pe="data:image/svg+xml,%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Transformed%20by:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20width='800px'%20height='800px'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20id='SVGRepo_bgCarrier'%20stroke-width='0'/%3e%3cg%20id='SVGRepo_tracerCarrier'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cg%20id='SVGRepo_iconCarrier'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M22%2012C22%2017.5228%2017.5228%2022%2012%2022C6.47715%2022%202%2017.5228%202%2012C2%206.47715%206.47715%202%2012%202C17.5228%202%2022%206.47715%2022%2012ZM8.96963%208.96965C9.26252%208.67676%209.73739%208.67676%2010.0303%208.96965L12%2010.9393L13.9696%208.96967C14.2625%208.67678%2014.7374%208.67678%2015.0303%208.96967C15.3232%209.26256%2015.3232%209.73744%2015.0303%2010.0303L13.0606%2012L15.0303%2013.9696C15.3232%2014.2625%2015.3232%2014.7374%2015.0303%2015.0303C14.7374%2015.3232%2014.2625%2015.3232%2013.9696%2015.0303L12%2013.0607L10.0303%2015.0303C9.73742%2015.3232%209.26254%2015.3232%208.96965%2015.0303C8.67676%2014.7374%208.67676%2014.2625%208.96965%2013.9697L10.9393%2012L8.96963%2010.0303C8.67673%209.73742%208.67673%209.26254%208.96963%208.96965Z'%20fill='%23ff5900'/%3e%3c/g%3e%3c/svg%3e",P=u=>new Promise((v,C)=>{setTimeout(()=>{v()},u)}),f=u=>(ie("data-v-9bce2ac1"),u=u(),ne(),u),ge={class:"main-anime-card-div"},he={key:0,class:"poster-div"},_e=["src","alt"],me={key:1,class:"wrap-loader-error"},Ce=f(()=>e("div",{class:"loader2"},null,-1)),we=[Ce],fe={key:2,class:"card-details"},be={class:"title"},ke={class:"year-ep-count"},ye={class:"episode-count"},xe={class:"year"},Se={key:3,class:"rating-div"},Te=f(()=>e("img",{height:"25px",src:ue,alt:""},null,-1)),Ve=["data-tooltip"],Le=["href"],De=f(()=>e("img",{class:"watch-img",src:de,alt:"watch-youtube-image"},null,-1)),Ge=[De],Ie=["src","onClick"],Re={key:5,class:"add-to-list-expanded-div"},Ae={class:"check-if-plan-to-watch"},Me={class:"checkbox-wrapper-58"},Ue={class:"switch"},Be=f(()=>e("span",{class:"slider"},null,-1)),Pe=f(()=>e("h4",null,"Anime da vedere",-1)),Ne={key:0},je={key:1,class:"add-episodes-div"},Ee=["onClick"],Ze=["onClick"],$e={key:2},ze={key:3,class:"add-episodes-div"},Fe={class:"comment-div"},We={class:"text-area-div"},Ye={key:1},He={class:"date-div"},Oe=f(()=>e("h5",null,"Data di inizio (opz.)",-1)),Qe={key:0},qe={key:6,class:"wrap-loader-error"},Je=f(()=>e("div",{class:"loader2"},null,-1)),Ke={class:"error-response-div"},Xe={__name:"AnimeCards",setup(u){const v=D("data"),C=D("isLoading"),w=c(!1);D("isLoggedIn");const _=c(!1),x=c(""),G=c(0),Y=()=>{G.value=x.value.length},b=c(null),k=c(!1),a=c(null),H=t=>{if(a.value===t){a.value=null,I();return}a.value=t,I()},I=()=>{i.value=0,g.value=1,x.value="",G.value=0,T.value=!1,y.value="",V.value="",_.value=!1,k.value=!1},i=c(0),S=t=>{if(i.value>t-1||i.value==="Completato"){k.value=!0,v.value[a.value].attributes.episodeCount===1&&(i.value=1);return}k.value=!1},O=t=>{if(i.value>=t-1||i.value==="Completato"){i.value="Completato",S(t);return}S(t),i.value++},Q=t=>{if(i.value<=0){i.value=0,S(t);return}if(i.value==="Completato"){i.value=t-1,S(t);return}i.value--,S(t)},g=c(1),q=()=>{if(g.value>=10){g.value=10;return}g.value+=.5},J=()=>{if(g.value<=1){g.value=1;return}g.value-=.5},T=c(!1),K=()=>{T.value=!T.value},y=c(""),V=c(""),R=t=>t.split("-").reverse().join("-"),N=D("userId"),X=async()=>{try{if(w.value=!0,_.value){const t=await $.post(`https://anime-vue-go-client-production.up.railway.app/add/anime/${N.value}`,{title:v.value[a.value].attributes.canonicalTitle,finished:!1,episodes:0,rating:0,comment:"",starting_date:y.value!==""?R(y.value):"",ending_date:"",plan_to_watch:!0,anime_id:parseInt(v.value[a.value].id)},{withCredentials:!0});t.status>=200&&t.status<=209&&(a.value=null,w.value=!1);return}else{const t=await $.post(`https://anime-vue-go-client-production.up.railway.app/add/anime/${N.value}`,{title:v.value[a.value].attributes.canonicalTitle,finished:k.value,episodes:i.value==="Completato"?v.value[a.value].attributes.episodeCount:i.value,rating:g.value,comment:x.value,starting_date:R(y.value),ending_date:R(V.value),plan_to_watch:!1,anime_id:parseInt(v.value[a.value].id)},{withCredentials:!0});t.status>=200&&t.status<=209&&(a.value=null,w.value=!1)}}catch(t){console.error(t),t.response.status===409?(b.value="Anime già presente nella tua lista",await P(2500),A()):t.response.status===400?(b.value="Errore, riprova più tardi",await P(2500),A()):t.response.status===401&&(b.value="Devi essere registrato per aggiungere anime alla lista!",await P(3e3),A())}},A=()=>{a.value=null,w.value=!1,b.value=null};return te(()=>v.value,()=>{a.value=null,w.value=!1,b.value=null}),(t,m)=>{const j=se("router-link");return o(),l(E,null,[M(ce),e("div",ge,[(o(!0),l(E,null,ae(n(v),(s,d)=>(o(),l("div",{key:d,class:"main-anime-display"},[!n(C)&&a.value!==d?(o(),l("div",he,[M(j,{to:{name:"AnimeInfo",params:{id:d}},class:"router-link"},{default:Z(()=>[e("img",{class:"anime-poster",src:s.attributes.posterImage.tiny,alt:s.attributes.canonicalTitle+" poster"},null,8,_e)]),_:2},1032,["to"])])):n(C)?(o(),l("div",me,we)):r("",!0),a.value!==d&&!n(C)?(o(),l("div",fe,[e("div",null,[M(j,{to:{name:"AnimeInfo",params:{id:d}},class:"router-link"},{default:Z(()=>[e("span",be,h(s.attributes.canonicalTitle.length>20&&s.attributes.abbreviatedTitles.length>0?n(z)(s.attributes.abbreviatedTitles):n(W)(s.attributes.canonicalTitle)),1)]),_:2},1032,["to"])]),e("div",ke,[e("span",ye,h(s.attributes.episodeCount>1?"Episodi: "+s.attributes.episodeCount:s.attributes.episodeCount===null?"N/A":"Film"),1),e("span",xe,h(s.attributes.endDate?"Anno: "+n(ve)(s.attributes.endDate):"In corso"),1)])])):r("",!0),a.value!==d&&!n(C)?(o(),l("div",Se,[Te,e("span",null,h(n(re)(s.attributes.averageRating)),1)])):r("",!0),a.value!==d&&!n(C)?(o(),l("div",{key:4,class:"trailer-link-div","data-tooltip":`https://www.youtube.com/watch?v=${s.attributes.youtubeVideoId}`},[e("span",null,[e("a",{href:`https://www.youtube.com/watch?v=${s.attributes.youtubeVideoId}`,target:"_blank",class:"watch-link"},Ge,8,Le)])],8,Ve)):r("",!0),e("div",{class:oe(a.value!==d?"add-to-list":"add-to-list-close"),"data-tooltip":"Aggiungi alla tua lista"},[n(C)?r("",!0):(o(),l("img",{key:0,height:"35px",src:a.value!==d?n(B):n(pe),alt:"add-to-list",onClick:p=>H(d),id:"add-to-list-button"},null,8,Ie))],2),a.value===d&&!w.value?(o(),l("div",Re,[e("h3",null," Aggiungi:   "+h(s.attributes.canonicalTitle.length>20&&s.attributes.abbreviatedTitles.length>0?n(z)(s.attributes.abbreviatedTitles):n(W)(s.attributes.canonicalTitle))+" alla tua lista ",1),e("div",Ae,[e("div",Me,[e("label",Ue,[L(e("input",{onClick:I,type:"checkbox","onUpdate:modelValue":m[0]||(m[0]=p=>_.value=p)},null,512),[[le,_.value]]),Be])]),Pe]),!_.value&&s.attributes.episodeCount!==null&&s.attributes.episodeCount!==1?(o(),l("h4",Ne," Numero di episodi visti ")):r("",!0),!_.value&&s.attributes.episodeCount!==null&&s.attributes.episodeCount!==1?(o(),l("div",je,[e("img",{height:"42px",src:F,onClick:p=>Q(s.attributes.episodeCount),alt:"minus-svg"},null,8,Ee),e("span",null,h(i.value),1),e("img",{height:"35px",src:B,onClick:p=>O(s.attributes.episodeCount),alt:"plus-svg"},null,8,Ze)])):r("",!0),_.value?r("",!0):(o(),l("h4",$e,"Voto")),_.value?r("",!0):(o(),l("div",ze,[e("img",{height:"42px",src:F,onClick:J,alt:"minus-svg"}),e("span",null,h(g.value),1),e("img",{height:"35px",src:B,onClick:q,alt:"plus-svg"})])),e("div",Fe,[e("button",{onClick:K},"Nota"),e("div",We,[T.value?L((o(),l("textarea",{key:0,onInput:Y,maxlength:"200","onUpdate:modelValue":m[1]||(m[1]=p=>x.value=p),name:"comment",id:"comment",cols:"20",rows:"5",placeholder:"Questo anime mi è piaciuto/non mi è piaciuto perché..."},`\r
            `,544)),[[U,x.value]]):r("",!0),T.value?(o(),l("span",Ye,h(G.value)+"/200",1)):r("",!0)])]),e("div",He,[Oe,L(e("input",{type:"date","onUpdate:modelValue":m[2]||(m[2]=p=>y.value=p),min:"2000-01-01",max:"2025-12-31"},null,512),[[U,y.value]]),k.value?(o(),l("h5",Qe,"Data di fine (opz.)")):r("",!0),k.value?L((o(),l("input",{key:1,type:"date","onUpdate:modelValue":m[3]||(m[3]=p=>V.value=p),min:"2000-01-01",max:"2025-12-31"},null,512)),[[U,V.value]]):r("",!0)]),e("div",{class:"submit-anime-div"},[e("button",{onClick:X},"Aggiungi")])])):r("",!0),w.value&&a.value===d?(o(),l("div",qe,[Je,e("div",Ke,[e("span",null,h(b.value),1)])])):r("",!0)]))),128))])],64)}}},ot=ee(Xe,[["__scopeId","data-v-9bce2ac1"]]);export{ot as default};
