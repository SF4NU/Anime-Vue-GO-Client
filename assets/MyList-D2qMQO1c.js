import{_ as ie,r as o,A as ne,o as s,c as a,d as t,F as ue,e as re,x as de,k as V,t as v,g as n,u as A,s as Q,h as $,v as ce,i as E,n as ve,p as pe,l as _e}from"./index-CmE2cy4c.js";import{c as Z,a as N,_ as he,b as q,d as G,e as me,f as ge}from"./cross-circle-svgrepo-com-BAm_C_UQ.js";import{t as D}from"./timeout-CKcjILrp.js";const p=F=>(pe("data-v-e943de68"),F=F(),_e(),F),fe=p(()=>t("h1",null,"Anime List",-1)),ke={class:"anime-container"},ye={key:0,class:"anime-card-wrap"},we={key:0},Ce={class:"completed-div"},xe=p(()=>t("span",null,"Finito: ",-1)),be=["src"],Ie={class:"dates-div"},Ae={key:0},De=p(()=>t("br",null,null,-1)),Fe={key:1},Le={key:1,class:"plan-to-watch-div"},Ve=p(()=>t("span",null," Da vedere ?",-1)),$e=["src"],Me={key:2,class:"comment-div"},Ue=["data-comment"],ze=p(()=>t("img",{height:"25px",src:ge,alt:""},null,-1)),Be={key:0,class:"show-comment"},Ee={class:"edit-div"},Ne=["onClick"],Re={key:1,class:"edit-div-wrapper"},Se={key:0,class:"edit-div"},Te=["onClick","src"],je={class:"title-div"},Qe={key:1,class:"check-if-plan-to-watch"},Ze={class:"checkbox-wrapper-58"},qe={class:"switch"},Ge=p(()=>t("span",{class:"slider"},null,-1)),He=p(()=>t("h4",null,"Anime da vedere",-1)),Je={key:2,class:"add-values-div"},Ke=p(()=>t("div",{class:"episodes-title-div"},[t("h4",null,"Episodi guardati")],-1)),Oe={class:"add-episodes-div"},Pe={key:3,class:"add-values-div"},We=p(()=>t("div",{class:"rating-title-div"},[t("h4",null,"Voto")],-1)),Xe={class:"rating-div"},Ye={key:4,class:"edit-comment-div"},et={class:"text-area-div"},tt={key:1},st={key:5,class:"date-div"},at=p(()=>t("h5",null,"Data di inizio (opz.)",-1)),lt={key:0},ot={key:6,class:"submit-anime-div"},it={key:7,class:"remove-anime-div","data-remove":"Rimuovi dalla lista"},nt={key:8,class:"wrap-loader-error"},ut=p(()=>t("div",{class:"loader"},null,-1)),rt={class:"error-response-div"},dt={__name:"MyList",setup(F){const H=de(),J=o(H.params.userId),R=o(!1),d=o(null),K=o(!1),h=o(null),u=o(0),_=o(1),f=o(!1),k=o(""),y=o(""),m=o(!1),M=o(null),r=o(!1),L=o(!1),w=o(""),U=o(0);o(""),o("");const O=o([]),P=o(""),g=o(""),C=o(null),z=()=>{u.value=0,_.value=1,f.value=!1,k.value="",y.value="",m.value=!1,w.value="",m.value=!1},W=()=>{L.value=!L.value},X=()=>{U.value=w.value.length},S=e=>e.split("-").reverse().join("-"),T=async(e,l)=>{if(h.value===e){h.value=null,z();return}h.value=e,z(),M.value=d.value[e].ID,u.value=d.value[e].episodes,_.value=d.value[e].rating,w.value=d.value[e].comment,U.value=d.value[e].comment.length,k.value=S(d.value[e].starting_date),y.value=S(d.value[e].ending_date),m.value=d.value[e].plan_to_watch,r.value=!0,await oe(l),x(C.value.attributes.episodeCount),r.value=!1},x=e=>{if(u.value>e-1||u.value==="Finito"){f.value=!0,u.value!=="Finito"&&(u.value="Finito"),C.value.attributes.episodeCount===1&&(u.value=1);return}f.value=!1},Y=e=>{if(u.value>=e-1||u.value==="Finito"){u.value="Finito",x(e);return}x(e),u.value++},ee=e=>{if(u.value<=0){u.value=0,x(e);return}if(u.value==="Finito"){u.value=e-1,x(e);return}u.value--,x(e)},te=()=>{if(_.value>=10){_.value=10;return}_.value+=.5},se=()=>{if(_.value<=1){_.value=1;return}_.value-=.5},B=async()=>{try{const e=await V.get(`https://anime-vue-go-client-production.up.railway.app/users/${J.value}/anime`,{withCredentials:!0});e.status>=200&&e.status<=209&&(d.value=e.data.sort((l,i)=>l.title.localeCompare(i.title)),O.value=d.value.map(l=>l.title),h.value=null,r.value=!1)}catch(e){console.error(e)}},j=e=>e.split("-").reverse().join("-"),I=()=>{h.value=null,r.value=!1,g.value=null},ae=async()=>{try{r.value=!0;const e=await V.put(`https://anime-vue-go-client-production.up.railway.app/update/anime/${M.value}`,{episodes:u.value==="Finito"?C.value.attributes.episodeCount:u.value,rating:_.value,finished:f.value,starting_date:k.value!==""?j(k.value):"",ending_date:y.value!==""&&f.value?j(y.value):"",plan_to_watch:m.value,comment:w.value},{withCredentials:!0});e.status>=200&&e.status<=209&&(g.value="Aggiunto!",await D(2e3),B(),I())}catch(e){console.error(e),e.response.status===400?(g.value="Errore, riprova più tardi",await D(2500),I()):(g.value="C'è stato un errore, non si sa perché!",await D(3e3),I())}},le=async()=>{try{r.value=!0;const e=await V.delete(`https://anime-vue-go-client-production.up.railway.app/delete/anime/${M.value}`,{withCredentials:!0});e.status>=200&&e.status<=209&&B()}catch(e){console.error(e),e.response.status===400?(g.value="Errore, riprova più tardi",await D(2500),I()):(g.value="C'è stato un errore, non si sa perché!",await D(3e3),I())}};ne(()=>{R.value||(R.value=!0,B())});const oe=async e=>{try{const l=await V.get(`https://kitsu.io/api/edge/anime?filter[id]=${e}&page[limit]=1`);C.value=l.data.data[0]}catch(l){console.error(l)}};return(e,l)=>(s(),a("section",null,[fe,t("div",ke,[(s(!0),a(ue,null,re(d.value,(i,b)=>(s(),a("div",{key:b,class:"anime-card"},[h.value!==b&&i.title!==P.value?(s(),a("div",ye,[t("h2",null,v(i.title),1),t("div",null,[t("span",null," Episodi guardati: "+v(i.episodes),1)]),i.plan_to_watch?n("",!0):(s(),a("div",we,[t("span",null," Voto assegnato: "+v(i.rating),1)])),t("div",Ce,[xe,t("img",{height:"20px",src:i.finished?A(Z):A(N),alt:""},null,8,be)]),t("div",Ie,[i.starting_date!==""?(s(),a("span",Ae," Inizio: "+v(i.starting_date),1)):n("",!0),De,!i.plan_to_watch&&i.finished?(s(),a("span",Fe," Fine: "+v(i.ending_date),1)):n("",!0)]),!i.finished&&i.plan_to_watch?(s(),a("div",Le,[Ve,Q("  "),t("img",{height:"20px",src:i.plan_to_watch?A(Z):A(N),alt:""},null,8,$e)])):n("",!0),i.comment!==""?(s(),a("div",Me,[t("button",{class:"comment-button","data-comment":i.comment},[Q(" Nota   "),ze],8,Ue),K.value?(s(),a("p",Be,v(i.comment),1)):n("",!0)])):n("",!0),t("div",Ee,[t("img",{onClick:c=>T(b,i.anime_id),height:"25px",src:he,alt:""},null,8,Ne)])])):n("",!0),h.value===b?(s(),a("div",Re,[r.value?n("",!0):(s(),a("div",Se,[t("img",{onClick:c=>T(b),height:"25px",src:A(N),alt:"cross-icon"},null,8,Te)])),t("div",je,[t("h2",null,v(i.title),1)]),r.value?n("",!0):(s(),a("div",Qe,[t("div",Ze,[t("label",qe,[$(t("input",{onClick:z,type:"checkbox","onUpdate:modelValue":l[0]||(l[0]=c=>m.value=c)},null,512),[[ce,m.value]]),Ge])]),He])),!m.value&&!r.value?(s(),a("div",Je,[Ke,t("div",Oe,[t("img",{height:"30px",src:q,onClick:l[1]||(l[1]=c=>ee(C.value.attributes.episodeCount)),alt:"minus-svg"}),t("span",null,v(u.value),1),t("img",{height:"25px",src:G,onClick:l[2]||(l[2]=c=>Y(C.value.attributes.episodeCount)),alt:"plus-svg"})])])):n("",!0),!m.value&&!r.value?(s(),a("div",Pe,[We,t("div",Xe,[t("img",{height:"30px",src:q,onClick:se,alt:"minus-svg"}),t("span",null,v(_.value),1),t("img",{height:"25px",src:G,onClick:te,alt:"plus-svg"})])])):n("",!0),r.value?n("",!0):(s(),a("div",Ye,[t("button",{onClick:W},"Nota"),t("div",et,[L.value?$((s(),a("textarea",{key:0,onInput:X,maxlength:"200","onUpdate:modelValue":l[3]||(l[3]=c=>w.value=c),name:"comment",id:"comment",cols:"20",rows:"5",placeholder:"Questo anime mi è piaciuto/non mi è piaciuto perché..."},`\r
              `,544)),[[E,w.value]]):n("",!0),L.value?(s(),a("span",tt,v(U.value)+"/200",1)):n("",!0)])])),r.value?n("",!0):(s(),a("div",st,[at,$(t("input",{type:"date","onUpdate:modelValue":l[4]||(l[4]=c=>k.value=c),min:"2000-01-01",max:"2025-12-31"},null,512),[[E,k.value]]),f.value?(s(),a("h5",lt,"Data di fine (opz.)")):n("",!0),f.value?$((s(),a("input",{key:1,type:"date","onUpdate:modelValue":l[5]||(l[5]=c=>y.value=c),min:"2000-01-01",max:"2025-12-31"},null,512)),[[E,y.value]]):n("",!0)])),r.value?n("",!0):(s(),a("div",ot,[t("button",{onClick:ae},"Modifica")])),r.value?n("",!0):(s(),a("div",it,[t("img",{onClick:le,height:"30px",src:me,alt:""})])),r.value&&h.value===b?(s(),a("div",nt,[ut,t("div",rt,[t("span",{class:ve(g.value==="Modificato!"?"error-blue":"")},v(g.value),3)])])):n("",!0)])):n("",!0)]))),128))])]))}},_t=ie(dt,[["__scopeId","data-v-e943de68"]]);export{_t as default};
